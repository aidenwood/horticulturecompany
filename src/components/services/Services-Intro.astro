---

/* Import the Services JS Data file */
import { services } from '../../content/landscaping-detailed.js';


---


<style>


  #contain { max-width: 1980px !important; }

  .main-carousel { width: 100%; max-height: 675px; }
  .main-carousel.is-expanded { width: 100%; }

  .carousel-cell {
    width: calc(100% - 24px);
  }

  /* transition height change */
  .flickity-viewport {
  transition: height 0.2s;
  }


  #hero {
    position: relative;
    background-size: cover;
    background-position: center;
    transition: background-image 0.5s ease-in;
    min-height: calc(100vh - 110px);
    
  }
  @media only screen and (max-width: 968px) {
  #hero {
    
    min-height: calc(100vh - 70px);
  }
}

  /* Overlay for better text readability */
  #hero::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.4);
    z-index: 1;
  }

  #contain {
    position: relative;
    z-index: 2;
    height: 100%; /* Make the container take full height */
    display: flex;
    flex-direction: column;
    justify-content: space-between; /* This will push content to top and bottom */
  }

  .main-carousel { 
    width: 100%; 
    max-height: 675px; 
  }
  
  .main-carousel.is-expanded { 
    width: 100%; 
  }
  
  .carousel-cell {
    max-width: 100%;
    margin: 10px;
  }

  /* transition height change */
  .flickity-viewport {
    transition: height 0.2s;
  }

  /* Content styling for better readability on background image */
  .content-box {
    border-radius: 0.375rem;
    padding: 1.5rem;
  }

  /* Add these new styles */
  #titleArea {
    margin-top: 2rem; /* Add some space from the very top */
  }

  #productInfoArea {
    margin-bottom: 2rem; /* Add some space from the very bottom */
    max-width: 1199px;
  }

  .seccarousel-cell {
    width: calc(25% - 15px);
    margin-right: 15px;
  }
  
  @media screen and (max-width: 1440px) {
    .seccarousel-cell {
      width: calc(20% - 45px);
      margin-right: 10px;
    }
  }

  @media screen and (max-width: 1280px) {
    .seccarousel-cell {
      width: auto;
      margin-right: 5px;
    }
  }

</style>


<!-- CSS -->
<link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
<!-- JavaScript -->
<script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>


<section id="hero" class="flex items-end">
  <div id="contain" class="text-white mx-auto w-full "> 
    
   
    
    <div id="productInfoArea" class="w-full flex flex-col justify-end pt-8 lg:pt-24">
      <div class="content-box flex flex-col justify-end gap-4">
        
        <div class="flex flex-col justify-end gap-4">
          <h1 class="text-base lg:text-lg uppercase font-thin tracking-widest">
            Book Event Services
          </h2>
          <h2 class="text-4xl md:text-5xl font-medium tracking-tight">
            Services
          </h2>
         
        </div>
        <div id="slider" class="carousel carousel-main pt-8" data-flickity='{ "pageDots": false }'>
          {
            services.map((service) => (
              <div class="carousel-cell bg-secondary-950/90 border-secondary-200 rounded-2xl border-2 gap-4 md:gap-8 flex flex-col md:flex-row items-start md:items-center duration-200 py-8 lg:py-6 px-4 lg:px-6">
                <div class="w-full md:w-2/5 min-h-full">
                  <div id="imageCover" class="aspect-ratio-box relative h-44 md:h-80 overflow-hidden rounded-xl">
                    <img
                      class="w-full h-full object-cover absolute inset-0 product-image"
                      src={service.serviceimg}
                      alt={service.alt}
                      data-background-image={service.img}
                    />
                  </div>
                </div>
                <div class="w-full lg:w-3/5 mx-auto flex flex-col gap-4 sm:gap-6">
                  <p class="hidden text-sm">{service.step}</p>
                  <h2 class="text-2xl md:text-3xl lg:text-4xl font-medium tracking-tight">{service.name}</h2>
                  <p class="text-sm md:text-lg pr-2 lg:pr-4 pb-4">
                    {service.description}
                  </p>
                  <div class="pb-2">
                    <a
                      href={service.link}
                      class="text-white bg-primary-600 border-2 border-primary-600 dark:hover:border-primary-200 dark:border-2 rounded-full px-4 py-3  text-sm xl:text-base font-semibold transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2"
                    >
                      More Info
                    </a>
                  </div>
                </div>
              </div>
            ))
          }
        </div>
      </div>
    </div>

    <section class="mt-2 mb-24">
      <div id="contain" class="mx-auto w-full">
      
        <!-- Perfect Slider Velocity8 - Start -->
        <div id="border" class="">
            
          
          <div class="carousel carousel-nav px-4 lg:px-6" data-flickity='{ "asNavFor": ".carousel-main", "contain": true, "pageDots": false, "adaptiveHeight": true, "freeScroll": true, "prevNextButtons": false }'>
            {
              services.map((service) => (
                
                <div class="seccarousel-cell shadow-md bg-secondary-950/90 border-secondary-200 hover:bg-secondary-600/60 hover:dark:bg-primary-700/20 duration-200 rounded-md border-2 xl:flex lg:flex-col md:items-center gap-2 md:gap-6 p-2 py-3 md:p-4 lg:p-6">
                  <div class="w-full mx-auto flex flex-row items-center justify-center">
                    
                    <div id="imageCover" class="hidden xl:block w-full aspect-ratio-box relative md:h-32 overflow-hidden rounded-xl">
                      <img
                      class="w-full h-full object-cover absolute inset-0 product-image"
                      width="640"
                      height="640"
                      src={service.serviceimg}
                      alt={service.alt}
                    />
                    </div>
                    
                 </div>
                 <div class="w-full ">
                  <h2 class="block text-left text-xs lg:text-sm xl:text-lg font-medium">{service.name}</h2>
                 </div>
                  
                </div>
              
              ))
            }
          </div>
    
        </div>
      </div>
    </section>
    
    
  </div>
</section>

<script client:load>
  let flkty = null;
  const heroSection = document.querySelector('#hero');
  
  function initSlider() {
    // Cleanup first
    if (flkty) {
      flkty.destroy();
      flkty = null;
    }
  
    // Initialize
    const sliderEl = document.querySelector('#slider');
    if (!sliderEl || !heroSection) return;
  
    // Set initial background
    const firstImage = sliderEl.querySelector('.product-image');
    if (firstImage) {
      heroSection.style.backgroundImage = `url(${firstImage.dataset.backgroundImage})`;
    }
  
    // Create new instance
    flkty = new window.Flickity(sliderEl, {
      pageDots: false,
      prevNextButtons: false,
    });
  
    // Change handler
    flkty.on('change', (index) => {
      const slide = sliderEl.querySelectorAll('.carousel-cell')[index];
      const image = slide?.querySelector('.product-image');
      if (image) heroSection.style.backgroundImage = `url(${image.dataset.backgroundImage})`;
    });
  }
  
  // Initial load
  initSlider();
  
  // Astro view transitions
  document.addEventListener('astro:before-swap', () => flkty?.destroy());
  document.addEventListener('astro:after-swap', initSlider);
  
  // Optional: Full page reload cleanup
  window.addEventListener('beforeunload', () => flkty?.destroy());
  </script>


<script>
document.addEventListener('DOMContentLoaded', function() {
  // Get the slider element
  const slider = document.querySelector('#slider');
  const heroSection = document.querySelector('#hero');
  
  // Set initial background image from the first slide
  const firstSlideImage = slider.querySelector('.product-image');
  if (firstSlideImage) {
    heroSection.style.backgroundImage = `url(${firstSlideImage.getAttribute('data-background-image')})`;
  }
  
  // Initialize Flickity with pageDots set to false
  const flkty = new Flickity(slider, {
    pageDots: false,  // This disables the page dots
    adaptiveHeight: true
  });
  
  // Change background image when slide changes
  flkty.on('change', function(index) {
    const currentSlide = slider.querySelectorAll('.carousel-cell')[index];
    const currentImage = currentSlide.querySelector('.product-image');
    
    if (currentImage) {
      const imageUrl = currentImage.getAttribute('data-background-image');
      heroSection.style.backgroundImage = `url(${imageUrl})`;
    }
  });
});
</script>